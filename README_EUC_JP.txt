conring by CACHE 2004/7/11 V0.4
--------------------------------------------------------------------
conringモジュールは、『コンテンツ・リング』を略した名前です。一言で言うならば『インデックス参照による自動コンテンツ配信モジュール』です。このモジュールは、ただインストールしただけでは、何の役にも立ちません。インターネットにサイトを持つ多くの方が、様々な得意な表現手段をお持ちと思います。ある人にとっては、言葉の表現そのもの。音楽、動画、画像、漫画、フラッシュと、ネット上で公開できる創作物は、多々あります。せっかくの創作物です。自サイトで公開するだけではなく、ＸＯＯＰＳでサイトを構築している人達のコンテンツを借りて、広く公開してみたいと思いませんか？

conrtingの仕組みは簡単です。予め厳格に決められたフォーマットに従って、インデックスファイルに自作品へのリンクその他の情報を登録していけば、それがそのまま、このモジュールをインストールした全てのサイトへ自動的に配信されます。今のところ扱えるコンテンツは、画像のみですが、表示スクリプトさえ書いてやれば、後からいくらでも種類を増やせます。ある意味、conringの心臓は、このインデックス・ファイルの仕様であり、モジュールはそれを表示する為に存在すると言えます。

このインデックスファイルは自サイト内に置いても良いのですが、多くのコンテンツが登録された外部のインデックスファイルを指定する事で、サイトの管理者がメンテナンスをしなくても、勝手に表示するコンテンツが増えていきます。また、インデックスファイルの仕様の中にコンテンツのメニューの段組表示のタイミングを指定するパラメータや、個々のコンテンツの表示のオン・オフを指定するパラメータがありますので、独自色を出す事も可能です。

このモジュールは作品を創作して登録する方が増えれば増える程、その魅力を増していきます。今は画像だけですので、表示できるコンテンツがとても限られています。しかし、メディアを表示する為のコードが書き足されるごとに、その表現の幅も広がるのです。あらかじめ拡張される事がさだめられているモジュールなので、バージョンは0.1からです。

※0.4で扱えるコンテンツが、音楽・動画・HTML・PDF・FLASH・JAVA APPLETに広がりました。更に拡張を予定しています。

※お願い
作品を配信しても良いと思われる方は、以下のＵＲＬの『しゃべり場』ＢＢＳのスレッドに作品単位のパラメーターで投稿して頂けると有りがたく思います。このモジュールは、個々のサイトでインデックスファイルを抱え込んでいると、魅力が半減します。一つの場所を決めて、そこで統括的に投稿作品をインデックスファイルへ設定して、そのファイルを皆で参照すれば、より多くの作品を配信・鑑賞する事ができます。よろしくお願い致します。
http://gyakubiki.kir.jp/
『逆引き生活歳時記』－しゃべり場－作品登録申請スレッド
※当サイトの『街の芸術館』にて、動作サンプルとして連載漫画『オー！ 逆引き君』をconringを使って表示させています。こういった作品メニューが何十個と並ぶ様を想像すると楽しく思えませんか？
--------------------------------------------------------------------
インストール方法

１．アーカイブ・ファイルを展開後、conringディレクトリー以下のファイルをmodulesディレクトリーへアップロードします。

２．パーミッションの変更
　　/cache->777
　　/cache/settings.txt->666
	/cache/select_settings.txt->666
３．システムのモジュール管理機能を使ってインストールします。
４．管理画面から有効にするインデックスファイルを選択・編集します。インデックスファィルは、目的に合わせて複数持てて、管理画面から有効にする事で機能します。最低１つのインデックスファイルが必要な為、最後の１つは削除できなくなっています。また、この管理画面での追加・編集・削除は、選択設定の為のもので、実インデックスファイルを操作するものではありません。
基本的には、自サイトのcacheディレクトリー下に設置しますが、多くの作品が登録されている外部のインデックスファイルが公開されていれば、http:～のURL指定で参照させる事で、その内容を自サイトに表示できます。
５．特定の１作品をプロックに表示させる事ができます。作品を選択せず、選択メニューを---< Random Display >---に設定した場合は、表示指定してある作品の中からランダムに選んで表示します。表示される画像の大きさは、配信元に依存しますので、表示場所には注意して下さい。
--------------------------------------------------------------------
インデックスファイルの仕様
・順番も含めて正確に指定する必要があります。
・このファイル自体は管理画面から編集できません。エディターで編集後にFTPなどでアップロードして下さい。
・テキストの漢字コードはＥＵＣです。
・全てのパラメーターに含まれるHTMLタグ、PHPコードは削除されます。
・インデックスファイルは、それをスクリプトの一部としてマージしてから実行するconringの仕様上、不正なコードを書かれるとサイトに被害が出る可能性があります。自分で作成したファイルならば問題ありませんが、外部の第三者が作成したインデックスファイルを指定する場合、必ず中身を確認してから指定して下さい。下記の＜説明＞以外のコードが書かれている場合、絶対にインデックスファイルとして指定してはいけません。

※インデックスファイルの設定をhttp://gyakubiki.kir.jp/modules/cache/settings3.txtに替えると、あらゆるオプションを指定したテスト用の設定ファイルが表示されます。タグの機能を視覚的に確認したい場合に試してみて下さい。ただし、こちらでデバッグ中の場合、表示が崩れる事もありますので、ご注意下さい。

＜パラメーターの設定例＞
従来は説明書に併記していましたが、扱えるメディアがとても増えたので長くなってしまい、ここへ併記するのに適さなくなってしまいました。スクリプトのディレクトリーの/cache/settings.txtに実例が記述されていますので、そちらを見ながら以下の説明を参照して下さい。

＜説明＞
全てのパラメーターは、PHPコードの一部として実行される為、<?php～?>に挟まれる形で記述されていなければならない。

配列の最初の次元は同一ジャンルである事を示す。同じジャンルに属する作品は、同じ番号で設定する。０から始まって、ジャンルが増える毎に＋１される。一つのジャンルに登録できるメニュー・作品の個数、もしくはジャンル自体の数に明確な上限は無い。システム資源の許す限り、無限に増やす事ができる。

配列の２番目の次元は同一メニューである事を示す。同じメニューに属する作品は、同じ番号で設定する。０から始まって、メニューが増える毎に＋１される。一つのメニューに登録できる作品の個数、もしくはメニュー自体の数に明確な上限は無い。システム資源の許す限り、無限に増やす事ができる。

配列の３番目の次元は、同じメニュー内の作品の区分けを示す。statusから始まって、各メディア固有のパラメーター群が、一つの作品に対してセットで設定され、０から始まって作品が増える毎＋１される。登録作品数に明確な上限はない。システム資源の許す限り、無限に増やす事ができる。

media...表示するコンテンツの内容を示すキーワードを記述。現在はpicture,music,movie,html,flash,javaのみ指定可能。

junle...見出しとして表示するテキスト・データか見出し用の画像ファイルのURLを設定する。また、ジャンルごと非表示にする場合にはOffを指定する。こちらの指定が、statusの指定より優先する。画像ファイルのURLを指定した場合には、"|"で区切って代替文字列を必ず指定する。この代替文字列は、ブロック表示をする場合のブロック編集画面のメニューとして使われる。

menu...コンテンツの集合単位で、ここで設定したテキスト・データが、そのまま階層トップのメニュー・リンクとして使用される。通常、登録サイト単位でメニュー分けされると思われるので、サイト名が入る。メニューとして表示するテキスト・データかメニュー用の画像ファイルのURLを設定する。メニュー単位で非表示にする場合には、Offを指定する。こちらにの指定が、statusの指定よりも優先する。画像ファイルのURLを指定した場合には、"|"で区切って代替文字列を必ず指定する。この代替文字列は、ブロック表示をする場合のブロック編集画面のメニューとして使われる。

column...メニューが複数ある時、改段したいタイミングのメニューの前に指定する。設定される事自体がフラグになっているので、設定される値は何でも良い。

page...一つのメニューに属する作品群の中で、改ページしたいタイミングで指定する。設定される事自体がフラグになっているので、設定される値は何でも良い。

media＝[picture]の作品単位のパラメーター群
１作品に一対で順番も含めて必ず全て指定する。指定するデータが無い場合は、空文字を指定する。
status...対応する作品を表示する場合はOn。しない場合はOff
link...表示する作品へのURLリンクを指定する。
title...作品のタイトルをテキストで指定する。
url...作品発表者のサイトのURL
copyright...著作権表示をテキストで指定する。
date...発表・製作・登録日時などをテキストで指定する。
message...解説・脚注・一言などをテキストで指定する。

media＝[music]の作品単位のパラメーター群
１作品に一対で順番も含めて必ず全て指定する。指定するデータが無い場合は、空文字を指定する。
status...対応する作品を表示する場合はOn。しない場合はOff
link...表示する作品へのURLリンクを指定する。
title...作品のタイトルをテキストで指定する。
composer...作曲者名など
lyricist...作詞者名など
singer...歌手名など
class...ジャンルで分けられる場合は、その名称（例・classic,Jpop...等）
url...作品発表者のサイトのURL
copyright...著作権表示をテキストで指定する。
date...発表・製作・登録日時などをテキストで指定する。
message...解説・脚注・一言などをテキストで指定する。
lyrics...歌詞がある場合に記述する。[br]で任意の場所で改行できる。HTMLコードは指定しても全て無視される。
controls...Windows MediaPlayer のコントロール・パラメーターを指定する。
例・"200|150|false|false|true|0|5|true|10000|true|true"
左から
width...幅・ピクセル値
height...高さ・ピクセル値
AutoStart...自動再生・true（有効）かfalse（無効）
AutoSize...自動サイズ・true（有効）かfalse（無効）
AutoRewind...再生終了後自動巻き戻し・true（有効）かfalse（無効）
Balance...音の左右バランス・-5000（左）～5000（右）
BufferingTime...バッファリングする時間
ShowStatusBar...ステータスバーの表示・true（有効）かfalse（無効）
Volume...音量・0（最小）～10000（最大）
ShowControls...コントロールバネルの表示・true（有効）かfalse（無効）
ShowAudioControls...オーディオコントロールパネルの表示・true（有効）かfalse（無効）

media＝[movie]の作品単位のパラメーター群
１作品に一対で順番も含めて必ず全て指定する。指定するデータが無い場合は、空文字を指定する。
status...対応する作品を表示する場合はOn。しない場合はOff
link...表示する作品へのURLリンクを指定する。
title...作品のタイトルをテキストで指定する。
director...監督名・中心人物名・リーダー名など
staff...協力者・分野別の担当者（音声・音楽など）
cast...出演者名・役名・登場人物名など
class...ジャンルで分けられる場合は、その名称（例・Animetion,Home Video...等）
url...作品発表者のサイトのURL
copyright...著作権表示をテキストで指定する。
date...発表・製作・登録日時などをテキストで指定する。
message...解説・脚注・一言などをテキストで指定する。
explanation...作品に関する解説。書式は自由。[br]で任意の位置で改行ができる。HTMLコードは全て無視する。
controls...Windows MediaPlayer のコントロール・パラメーターを指定する。
例・"200|150|false|false|true|0|5|true|10000|true|true"
左から
width...幅・ピクセル値
height...高さ・ピクセル値
AutoStart...自動再生・true（有効）かfalse（無効）
AutoSize...自動サイズ・true（有効）かfalse（無効）
AutoRewind...再生終了後自動巻き戻し・true（有効）かfalse（無効）
Balance...音の左右バランス・-5000（左）～5000（右）
BufferingTime...バッファリングする時間
ShowStatusBar...ステータスバーの表示・true（有効）かfalse（無効）
Volume...音量・0（最小）～10000（最大）
ShowControls...コントロールバネルの表示・true（有効）かfalse（無効）
ShowAudioControls...オーディオコントロールパネルの表示・true（有効）かfalse（無効）
AnimationAtStart...スタート時のアニメーション・true（有効）かfalse（無効）

media＝[html]の作品単位のパラメーター群
１作品に一対で順番も含めて必ず全て指定する。指定するデータが無い場合は、空文字を指定する。
status...対応する作品を表示する場合はOn。しない場合はOff
title...作品のタイトルをテキストで指定する。
writer...作成者
editor...編集者
staff...協力者・共著者など
class...ジャンルで分けられる場合は、その名称（例・Novel,Diary,Manual...等）
url...作品発表者のサイトのURL
copyright...著作権表示をテキストで指定する。
date...発表・製作・登録日時などをテキストで指定する。
message...解説・脚注・一言などをテキストで指定する。
explanation...作品に関する解説。書式は自由。[br]で任意の位置で改行ができる。HTMLコードは全て無視する。
onlinelink...オンラインで公開するhtmlのリンク先を指定する。最初にリンク用の文字列か画像ファイルのURLを指定。|で区切って続けて表示するリンク先のHTMLファイルのURLを指定する。
offlinelink...ダウンロードしてオフラインで閲覧する為のアーカイブ・ファイルを指定する。最初にリンク用の文字列か画像ファイルのURLを指定。|で区切って続けてダウンロード用アーカイブ・ファイルのURLを指定する。
※PDFファイルの場合も、conring上の扱いではmedia=HTMLで扱います。

media＝[flash]の作品単位のパラメーター群
１作品に一対で順番も含めて必ず全て指定する。指定するデータが無い場合は、空文字を指定する。
status...対応する作品を表示する場合はOn。しない場合はOff
title...作品のタイトルをテキストで指定する。
director...監督者名・リーダー名など
cast...出演者名・役名など
staff...協力者・役割別担当者（音楽担当・アニメーション担当...）など
class...ジャンルで分けられる場合は、その名称（例・Game,Animation...等）
url...作品発表者のサイトのURL
copyright...著作権表示をテキストで指定する。
date...発表・製作・登録日時などをテキストで指定する。
message...解説・脚注・一言などをテキストで指定する。
explanation...作品に関する解説。書式は自由。[br]で任意の位置で改行ができる。HTMLコードは全て無視する。
flash-controls99...flashで指定可能なパラメーターを指定する。パラメーター名=パラメーター値の書式。パラメーターの種類は、Flashの開発元のmicro mediaのホームページなどを参照のこと。各作品固有の<param name="xxxxx" value="xxxxx">形式のパラメーターも指定できる。１パラメーターに１行。"flash-controls"+任意の文字の形式でパラメーター名を指定する。重複しなければ、任意部分は何でも良い。
onlinelink...オンラインで公開するflashのリンク先を指定する。最初にリンク用の文字列か画像ファイルのURLを指定。|で区切って続けて表示するリンク先のflashファイルのURLを指定する。

media＝[java]の作品単位のパラメーター群
１作品に一対で順番も含めて必ず全て指定する。指定するデータが無い場合は、空文字を指定する。
status...対応する作品を表示する場合はOn。しない場合はOff
title...作品のタイトルをテキストで指定する。
creater...製作者・プログラマーなど
class...ジャンルで分けられる場合は、その名称（例・Game,message roll...等）
url...作品発表者のサイトのURL
copyright...著作権表示をテキストで指定する。
date...発表・製作・登録日時などをテキストで指定する。
message...解説・脚注・一言などをテキストで指定する。
explanation...作品に関する解説。書式は自由。[br]で任意の位置で改行ができる。HTMLコードは全て無視する。
java-controls99...java appletで指定可能なパラメーターを指定する。パラメーター名=パラメーター値の書式。パラメーターの種類は、javaの開発元のSunのホームページなどを参照のこと。各作品固有の<param name="xxxxx" value="xxxxx">形式のパラメーターも指定できる。１パラメーターに１行。"java-controls"+任意の文字の形式でパラメーター名を指定する。重複しなければ、任意部分は何でも良い。
onlinelink...オンラインで公開するjava appletのリンク先を指定する。最初にリンク用の文字列か画像ファイルのURLを指定。|で区切って続けて表示するリンク先のflashファイルのURLを指定する。
offlinelink...ダウンロード用java appletアーカイブ・ファイルのリンク先を指定する。最初にリンク用の文字列か画像ファイルのURLを指定。|で区切って続けて表示するリンク先のjava appletアーカイブ・ファイルのURLを指定する。

※flashとJava Appletに関する注意。
コードの製作段階の問題で、表示しているHTMLファイルと同じディレクトリに置かないと表示できないものがあります。外部の音声ファイルや背景画像を参照して動作するものに多いようです。参照するファイルが表示するHTMLと同じディレクトリにあると決めでコードが設計されている事が原因です。これは設置する側では、どうしようもない問題なので、モジュールで表示する場合には、conringディレクトリー(直接表示しているのがshow.phpである為）へ設置する必要があります。スクリプトの吐き出すHTML文にはcodebaseを指定しているので、汎用的な設計になっている場合には、何処に置いても動作するはずです。
---------------------------------------------------------------------
変更履歴
2004/6/20 V0.1->V0.2
・セキュリティー対策として、パラメータ中のHTMLタグ、PHPタグを無視するコードを追加。
・任意のタイミングで改ページをし、自動的に他ページへの参照インデックスを付加する[page]タグを追加。

2004/6/22 V0.2->V0.3
・[item]タグを廃止して、［junle]タグに機能統合。
・[junle]タグと[menu]タグに、それぞれの単位で表示をオフにする機能を付加。
・[menu]タグに、テキストだけではなく見出し用画像も表示できる機能を付加。
・[junle],[menu]タグで画像URLを指定した場合、代替文字列を指定する仕様を追加。
・ジャンル単位でも区分けできるように、配列の階層を２－＞３に変更。
・一つのメニューに登録できる作品の数を無制限に変更。

2004/07/10 V0.3->V0.4
・動画ファイル（avi mpg mpeg wmv wmp rm)の再生機能を付加
・音楽ファイル（mp3 wav mid wmp）の再生機能を付加
・Flashファイル（swf）の再生機能を付加
・Java Applet（class）の表示機能を付加
・HTMLファイルの表示・一覧機能を付加
・PDFファイルの表示・一覧機能を付加
